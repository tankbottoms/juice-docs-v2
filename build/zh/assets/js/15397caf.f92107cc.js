"use strict";(self.webpackChunkjuice_docs_v_2=self.webpackChunkjuice_docs_v_2||[]).push([[94419],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var a=n(67294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var u=a.createContext({}),c=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(u.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,u=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(n),f=l,m=d["".concat(u,".").concat(f)]||d[f]||s[f]||r;return n?a.createElement(m,o(o({ref:t},p),{},{components:n})):a.createElement(m,o({ref:t},p))}));function f(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,o=new Array(r);o[0]=d;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var c=2;c<r;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67294),l=n(86010);const r="tabItem_Ymn6";function o(e){let{children:t,hidden:n,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,l.Z)(r,o),hidden:n},t)}},65488:(e,t,n)=>{n.d(t,{Z:()=>f});var a=n(87462),l=n(67294),r=n(86010),o=n(72389),i=n(67392),u=n(7094),c=n(12466);const p="tabList__CuJ",s="tabItem_LNqP";function d(e){var t,n;const{lazy:o,block:d,defaultValue:f,values:m,groupId:b,className:h}=e,g=l.Children.map(e.children,(e=>{if((0,l.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),y=null!=m?m:g.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),k=(0,i.l)(y,((e,t)=>e.value===t.value));if(k.length>0)throw new Error('Docusaurus error: Duplicate values "'+k.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.');const v=null===f?f:null!=(t=null!=f?f:null==(n=g.find((e=>e.props.default)))?void 0:n.props.value)?t:g[0].props.value;if(null!==v&&!y.some((e=>e.value===v)))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+v+'" but none of its children has the corresponding value. Available values are: '+y.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");const{tabGroupChoices:N,setTabGroupChoices:_}=(0,u.U)(),[C,j]=(0,l.useState)(v),O=[],{blockElementScrollPositionUntilNextRender:w}=(0,c.o5)();if(null!=b){const e=N[b];null!=e&&e!==C&&y.some((t=>t.value===e))&&j(e)}const T=e=>{const t=e.currentTarget,n=O.indexOf(t),a=y[n].value;a!==C&&(w(t),j(a),null!=b&&_(b,String(a)))},B=e=>{var t;let n=null;switch(e.key){case"ArrowRight":{var a;const t=O.indexOf(e.currentTarget)+1;n=null!=(a=O[t])?a:O[0];break}case"ArrowLeft":{var l;const t=O.indexOf(e.currentTarget)-1;n=null!=(l=O[t])?l:O[O.length-1];break}}null==(t=n)||t.focus()};return l.createElement("div",{className:(0,r.Z)("tabs-container",p)},l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":d},h)},y.map((e=>{let{value:t,label:n,attributes:o}=e;return l.createElement("li",(0,a.Z)({role:"tab",tabIndex:C===t?0:-1,"aria-selected":C===t,key:t,ref:e=>O.push(e),onKeyDown:B,onFocus:T,onClick:T},o,{className:(0,r.Z)("tabs__item",s,null==o?void 0:o.className,{"tabs__item--active":C===t})}),null!=n?n:t)}))),o?(0,l.cloneElement)(g.filter((e=>e.props.value===C))[0],{className:"margin-top--md"}):l.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,l.cloneElement)(e,{key:t,hidden:e.props.value!==C})))))}function f(e){const t=(0,o.Z)();return l.createElement(d,(0,a.Z)({key:String(t)},e))}},72098:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>u,default:()=>f,frontMatter:()=>i,metadata:()=>c,toc:()=>s});var a=n(87462),l=(n(67294),n(3905)),r=n(65488),o=n(85162);const i={},u="_ballotStateOf",c={unversionedId:"dev/api/contracts/jbfundingcyclestore/read/-_ballotstateof",id:"dev/api/contracts/jbfundingcyclestore/read/-_ballotstateof",title:"_ballotStateOf",description:"Contract: JBFundingCycleStore\u200b",source:"@site/docs/dev/api/contracts/jbfundingcyclestore/read/-_ballotstateof.md",sourceDirName:"dev/api/contracts/jbfundingcyclestore/read",slug:"/dev/api/contracts/jbfundingcyclestore/read/-_ballotstateof",permalink:"/zh/dev/api/contracts/jbfundingcyclestore/read/-_ballotstateof",draft:!1,editUrl:"https://github.com/jbx-protocol/juice-docs-v2/blob/main/docs/dev/api/contracts/jbfundingcyclestore/read/-_ballotstateof.md",tags:[],version:"current",frontMatter:{},sidebar:"dev",previous:{title:"latestConfigurationOf",permalink:"/zh/dev/api/contracts/jbfundingcyclestore/properties/latestconfigurationof"},next:{title:"_deriveNumberFrom",permalink:"/zh/dev/api/contracts/jbfundingcyclestore/read/-_derivenumberfrom"}},p={},s=[{value:"Definition",id:"definition",level:4},{value:"Body",id:"body",level:4}],d={toc:s};function f(e){let{components:t,...n}=e;return(0,l.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"_ballotstateof"},"_ballotStateOf"),(0,l.kt)("p",null,"Contract: ",(0,l.kt)("a",{parentName:"p",href:"/zh/dev/api/contracts/jbfundingcyclestore/"},(0,l.kt)("inlineCode",{parentName:"a"},"JBFundingCycleStore")),"\u200b"),(0,l.kt)(r.Z,{mdxType:"Tabs"},(0,l.kt)(o.Z,{value:"Step by step",label:"Step by step",mdxType:"TabItem"},(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"A project's latest funding cycle configuration approval status.")),(0,l.kt)("h4",{id:"definition"},"Definition"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"function _ballotStateOf(\n  uint256 _projectId,\n  uint256 _configuration,\n  uint256 _start,\n  uint256 _ballotFundingCycleConfiguration\n) private view returns (JBBallotState) { ... }\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Arguments:",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"_projectId")," is the ID of the project to which the funding cycle belongs."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"_configuration")," is the funding cycle configuration to get the ballot state of."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"_start")," is the start time of the funding cycle configuration to get the ballot state of."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"_ballotFundingCycleConfiguration")," is the configuration of the funding cycle which is configured with the ballot that should be used."))),(0,l.kt)("li",{parentName:"ul"},"The view function is private to this contract."),(0,l.kt)("li",{parentName:"ul"},"The view function does not alter state on the blockchain."),(0,l.kt)("li",{parentName:"ul"},"The function returns the ",(0,l.kt)("a",{parentName:"li",href:"/zh/dev/api/enums/jbballotstate"},(0,l.kt)("inlineCode",{parentName:"a"},"JBBallotState"))," of the project.")),(0,l.kt)("h4",{id:"body"},"Body"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"If there is no ballot configuration, the ballot state is implicitly approved."),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"// If there is no ballot funding cycle, implicitly approve.\nif (_ballotFundingCycleConfiguration == 0) return JBBallotState.Approved;\n")),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("em",{parentName:"p"},"Enums used:")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/zh/dev/api/enums/jbballotstate"},(0,l.kt)("inlineCode",{parentName:"a"},"JBBallotState")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},".Approved")))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Get the funding cycle that has a reference of the ballot that should be used."),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"// Get the ballot funding cycle.\nJBFundingCycle memory _ballotFundingCycle = _getStructFor(\n  _projectId,\n  _ballotFundingCycleConfiguration\n);\n")),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("em",{parentName:"p"},"Internal references:")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/zh/dev/api/contracts/jbfundingcyclestore/read/-_getstructfor"},(0,l.kt)("inlineCode",{parentName:"a"},"_getStructFor"))))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"If there's no ballot, the funding cycle configuration is implicitly approved. Otherwise if the ballot's duration has not yet expired, it is implicitly active. Otherwise, return the state that the ballot for the provided configuration."),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre"},"// If there is no ballot, the ID is auto approved.\n// Otherwise if the ballot's duration hasn't passed, its still active.\n// Otherwise, return the ballot's state.\nif (_ballotFundingCycle.ballot == IJBFundingCycleBallot(address(0)))\n  return JBBallotState.Approved;\nelse if (_ballotFundingCycle.ballot.duration() >= block.timestamp - _configuration)\n  return JBBallotState.Active;\nelse return _ballotFundingCycle.ballot.stateOf(_projectId, _configuration, _start);\n")),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("em",{parentName:"p"},"Enums used:")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/zh/dev/api/enums/jbballotstate"},(0,l.kt)("inlineCode",{parentName:"a"},"JBBallotState")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},".Approved")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},".Active"))))),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("em",{parentName:"p"},"External references:")),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/zh/dev/api/interfaces/ijbfundingcycleballot"},(0,l.kt)("inlineCode",{parentName:"a"},"duration"))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/zh/dev/api/interfaces/ijbfundingcycleballot"},(0,l.kt)("inlineCode",{parentName:"a"},"stateOf"))))))),(0,l.kt)(o.Z,{value:"Code",label:"Code",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"/**\n  @notice \n  A project's latest funding cycle configuration approval status.\n\n  @param _projectId The ID of the project to which the funding cycle belongs.\n  @param _configuration The funding cycle configuration to get the ballot state of.\n  @param _start The start time of the funding cycle configuration to get the ballot state of.\n  @param _ballotFundingCycleConfiguration The configuration of the funding cycle which is configured with the ballot that should be used.\n\n  @return The ballot state of the project.\n*/\nfunction _ballotStateOf(\n  uint256 _projectId,\n  uint256 _configuration,\n  uint256 _start,\n  uint256 _ballotFundingCycleConfiguration\n) private view returns (JBBallotState) {\n  // If there is no ballot funding cycle, implicitly approve.\n  if (_ballotFundingCycleConfiguration == 0) return JBBallotState.Approved;\n\n  // Get the ballot funding cycle.\n  JBFundingCycle memory _ballotFundingCycle = _getStructFor(\n    _projectId,\n    _ballotFundingCycleConfiguration\n  );\n\n  // If there is no ballot, the ID is auto approved.\n  // Otherwise if the ballot's duration hasn't passed, its still active.\n  // Otherwise, return the ballot's state.\n  if (_ballotFundingCycle.ballot == IJBFundingCycleBallot(address(0)))\n    return JBBallotState.Approved;\n  else if (_ballotFundingCycle.ballot.duration() >= block.timestamp - _configuration)\n    return JBBallotState.Active;\n  else return _ballotFundingCycle.ballot.stateOf(_projectId, _configuration, _start);\n}\n"))),(0,l.kt)(o.Z,{value:"Bug bounty",label:"Bug bounty",mdxType:"TabItem"},(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Category"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"),(0,l.kt)("th",{parentName:"tr",align:null},"Reward"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Optimization")),(0,l.kt)("td",{parentName:"tr",align:null},"Help make this operation more efficient."),(0,l.kt)("td",{parentName:"tr",align:null},"0.5ETH")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Low severity")),(0,l.kt)("td",{parentName:"tr",align:null},"Identify a vulnerability in this operation that could lead to an inconvenience for a user of the protocol or for a protocol developer."),(0,l.kt)("td",{parentName:"tr",align:null},"1ETH")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"High severity")),(0,l.kt)("td",{parentName:"tr",align:null},"Identify a vulnerability in this operation that could lead to data corruption or loss of funds."),(0,l.kt)("td",{parentName:"tr",align:null},"5+ETH")))))))}f.isMDXComponent=!0}}]);